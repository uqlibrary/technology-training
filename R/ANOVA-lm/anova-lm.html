<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="UQ Library">
<meta name="dcterms.date" content="2026-01-26">

<title>R statistics: ANOVA and linear regression – UQ Library Technology Training</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../..//images/laptop_icon.svg" rel="icon" type="image/svg+xml">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-464d469a26f3df86c765af02c3901629.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script id="quarto-axe-checker-options" type="text/plain">dHJ1ZQ==</script>
<link href="../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="R statistics: ANOVA and linear regression – UQ Library Technology Training">
<meta property="og:description" content="">
<meta property="og:image" content="https://uqlibrary.github.io/technology-training/images/R.svg">
<meta property="og:site_name" content="UQ Library Technology Training">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">UQ Library Technology Training</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Orientation/orientation.html"> 
<span class="menu-text">O-Week</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-user-groups" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">User Groups</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-user-groups">    
        <li>
    <a class="dropdown-item" href="https://uqrug.netlify.app/">
 <span class="dropdown-text">UQ R User Group</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://uqpug.github.io/">
 <span class="dropdown-text">UQ Python User Group</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="https://uqlibrary.github.io/technology-training-intensives/"> 
<span class="menu-text">Training Intensives</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../more_training.html"> 
<span class="menu-text">Training Elsewhere</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://web.library.uq.edu.au/study-and-learning-support/training-and-workshops/online-and-person-workshops#keyword=;campus=;weekstart="> 
<span class="menu-text"><strong>Book a Workshop</strong></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/uqlibrary/technology-training" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../R/installation.html"><img src="../../images/R.svg" class="img-fluid" width="20"> R with RStudio</a></li><li class="breadcrumb-item"><a href="../../R/ANOVA-lm/anova-lm.html">10. ANOVA and linear regression</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Acrobat/acrobat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><img src="../../images/acrobat.svg" class="img-fluid" width="20"> Acrobat</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Audacity/audacity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><img src="../../images/audacity.svg" class="img-fluid" width="20"> Audacity</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Excel/excel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><img src="../../images/excel.svg" class="img-fluid" width="20"> Excel</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../GenAI/genai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><img src="../../images/ChatGPT_logo.svg" class="img-fluid" width="20"> GenAI</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text"><img src="../../images/git.svg" class="img-fluid" width="20"> Git</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Git/git.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Git from the command line</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Git/GitHub/GitHub_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GitHub and portfolios</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../LaTeX/overleaf_latex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><img src="../../images/overleaf.svg" class="img-fluid" width="20"> <span class="math inline">\(\LaTeX\)</span> with Overleaf</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Loop/loop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><img src="../../images/loop.svg" class="img-fluid" width="20"> Loop</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../NVivo/nvivo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><img src="../../images/nvivo.png" class="img-fluid" width="20"> NVivo</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../OpenRefine/openrefine.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><img src="../../images/openrefine.svg" class="img-fluid" width="20"> OpenRefine</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../OSM/OpenStreetMap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><img src="../../images/openstreetmap.svg" class="img-fluid" width="20"> OpenStreetMap</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Photoshop/photoshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><img src="../../images/photoshop.svg" class="img-fluid" width="20"> Photoshop</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../PowerPoint/powerpoint.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><img src="../../images/powerpoint.svg" class="img-fluid" width="20"> PowerPoint</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Premiere_Pro/premiere_pro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><img src="../../images/premiere_pro.svg" class="img-fluid" width="20"> Premiere Pro</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text"><img src="../../images/python.svg" class="img-fluid" width="20"> Python</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Python/1-fundamentals/fundamentals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. The Fundamentals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Python/2-data_processing/data_processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Managing Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Python/3-intro_visualisation/visualisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Introductory Data Visualisation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Python/4-stats_and_further_vis/stats_and_vis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Statistics and Further Visualisation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Python/5-python_toolkit/python_toolkit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. Building your Python toolkit</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Python/useful_links.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Further resources</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text"><img src="../../images/QGIS.svg" class="img-fluid" width="20"> QGIS</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../QGIS/intro/QGIS_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../QGIS/reports/QGIS_reports.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Refined Maps for Publication</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../QGIS/raster/QGIS_raster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Raster analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../QGIS/vector/QGIS_vector.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Vector analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../QGIS/fieldwork/QGIS_fieldwork.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. Fieldwork Data Collection</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Qualtrics/qualtrics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><img src="../../images/XM.svg" class="img-fluid" width="20"> Qualtrics</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text"><img src="../../images/R.svg" class="img-fluid" width="20"> R with RStudio</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../R/installation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">0. Installing R and RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../R/rstudio_intro/rstudio_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Getting started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../R/dplyr/dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. dplyr: data transformation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../R/ggplot2_intro/ggplot2_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. ggplot2: introduction to visualisation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../R/ggplot2_intermediate/ggplot2_intermediate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. ggplot2: intermediate visualisation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../R/tidyverse_next_steps/tidyverse_next_steps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. tidyr and purrr: tidying and loops</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../R/reports/reports.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6. Quarto: reproducible publishing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../R/heatmaps/heatmaps_intermediate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7. Heatmaps</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../R/shiny/shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8. Shiny web apps</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../R/packaging/packaging.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. Functions and packaging</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../R/ANOVA-lm/anova-lm.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">10. ANOVA and linear regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../R/usefullinks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Further resources</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../uMap/umap_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><img src="../../images/uMap.svg" class="img-fluid" width="20"> uMap</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Shell/shell_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><img src="../../images/bash.svg" class="img-fluid" width="20"> Unix Shell</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Voyant/voyant.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><img src="../../images/voyant.png" class="img-fluid" width="20"> Voyant Tools</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Word/word.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><img src="../../images/word.svg" class="img-fluid" width="20"> Word</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#what-are-we-going-to-learn" id="toc-what-are-we-going-to-learn" class="nav-link active" data-scroll-target="#what-are-we-going-to-learn">What are we going to learn?</a></li>
  <li><a href="#keep-in-mind" id="toc-keep-in-mind" class="nav-link" data-scroll-target="#keep-in-mind">Keep in mind</a>
  <ul class="collapse">
  <li><a href="#help" id="toc-help" class="nav-link" data-scroll-target="#help">Help</a></li>
  </ul></li>
  <li><a href="#open-rstudio" id="toc-open-rstudio" class="nav-link" data-scroll-target="#open-rstudio">Open RStudio</a></li>
  <li><a href="#setting-up" id="toc-setting-up" class="nav-link" data-scroll-target="#setting-up">Setting up</a>
  <ul class="collapse">
  <li><a href="#install-and-load-required-packages-for-first-sections" id="toc-install-and-load-required-packages-for-first-sections" class="nav-link" data-scroll-target="#install-and-load-required-packages-for-first-sections">Install and load required packages for first sections</a></li>
  <li><a href="#new-project" id="toc-new-project" class="nav-link" data-scroll-target="#new-project">New project</a></li>
  <li><a href="#create-a-script" id="toc-create-a-script" class="nav-link" data-scroll-target="#create-a-script">Create a script</a></li>
  <li><a href="#introducing-our-data" id="toc-introducing-our-data" class="nav-link" data-scroll-target="#introducing-our-data">Introducing our data</a></li>
  </ul></li>
  <li><a href="#statistics-in-r-using-base-and-stats" id="toc-statistics-in-r-using-base-and-stats" class="nav-link" data-scroll-target="#statistics-in-r-using-base-and-stats">Statistics in R using base and stats</a>
  <ul class="collapse">
  <li><a href="#visualise-the-data" id="toc-visualise-the-data" class="nav-link" data-scroll-target="#visualise-the-data">Visualise the data</a></li>
  <li><a href="#analysis-of-variance-anova" id="toc-analysis-of-variance-anova" class="nav-link" data-scroll-target="#analysis-of-variance-anova">Analysis of Variance (ANOVA)</a></li>
  <li><a href="#linear-model" id="toc-linear-model" class="nav-link" data-scroll-target="#linear-model">Linear Model</a></li>
  </ul></li>
  <li><a href="#the-inbetween" id="toc-the-inbetween" class="nav-link" data-scroll-target="#the-inbetween">The inbetween…</a></li>
  <li><a href="#introducing-tidymodels" id="toc-introducing-tidymodels" class="nav-link" data-scroll-target="#introducing-tidymodels">Introducing Tidymodels</a>
  <ul class="collapse">
  <li><a href="#load-more-packages" id="toc-load-more-packages" class="nav-link" data-scroll-target="#load-more-packages">Load more packages</a></li>
  <li><a href="#build-and-fit-a-model" id="toc-build-and-fit-a-model" class="nav-link" data-scroll-target="#build-and-fit-a-model">Build and fit a model</a></li>
  </ul></li>
  <li><a href="#use-a-model-to-predict" id="toc-use-a-model-to-predict" class="nav-link" data-scroll-target="#use-a-model-to-predict">Use a model to predict</a></li>
  <li><a href="#close-project" id="toc-close-project" class="nav-link" data-scroll-target="#close-project">Close project</a></li>
  <li><a href="#useful-links" id="toc-useful-links" class="nav-link" data-scroll-target="#useful-links">Useful links</a></li>
  <li><a href="#licence" id="toc-licence" class="nav-link" data-scroll-target="#licence">Licence</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../R/installation.html"><img src="../../images/R.svg" class="img-fluid" width="20"> R with RStudio</a></li><li class="breadcrumb-item"><a href="../../R/ANOVA-lm/anova-lm.html">10. ANOVA and linear regression</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">R statistics: ANOVA and linear regression</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>UQ Library </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 26, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="what-are-we-going-to-learn" class="level2">
<h2 class="anchored" data-anchor-id="what-are-we-going-to-learn">What are we going to learn?</h2>
<p>In this hands-on session, you will use R, RStudio to run analysis of variance (ANOVA) and linear regression models.</p>
<p>Specifically, you will learn about:</p>
<ul>
<li>data visualisation in base R and ggplot2</li>
<li>analysis of variance (ANOVA) in base R</li>
<li>linear models in base R</li>
<li>the tidy model approach</li>
</ul>
</section>
<section id="keep-in-mind" class="level2">
<h2 class="anchored" data-anchor-id="keep-in-mind">Keep in mind</h2>
<ul>
<li>Everything we write today will be saved in your project. Please remember to save it in your H drive or USB if you are using a Library computer.</li>
<li>R is case sensitive: it will tell the difference between uppercase and lowercase.</li>
<li>Respect the naming rules for objects (no spaces, does not start with a number…)</li>
</ul>
<section id="help" class="level3">
<h3 class="anchored" data-anchor-id="help">Help</h3>
<p>For any dataset or function doubts that you might have, don’t forget the three ways of getting help in RStudio:</p>
<ol type="1">
<li>the shortcut command: <code>?functionname</code></li>
<li>the help function: <code>help(functionname)</code></li>
<li>the keyboard shortcut: press F1 with your cursor on a function name</li>
</ol>
</section>
</section>
<section id="open-rstudio" class="level2">
<h2 class="anchored" data-anchor-id="open-rstudio">Open RStudio</h2>
<ul>
<li>If you are using your own laptop please open RStudio
<ul>
<li>If you need them, we have <a href="../../R/installation.html">installation instructions</a></li>
</ul></li>
<li>Make sure you have a working internet connection</li>
<li>On Library computers (the first time takes about 10 min.):
<ul>
<li>Log in with your UQ credentials (student account if you have two)</li>
<li>Make sure you have a working internet connection</li>
<li>Go to search at bottom left corner (magnifying glass)</li>
<li>Open the ZENworks application</li>
<li>Look for RStudio</li>
<li>Double click on RStudio which will install both R and RStudio</li>
</ul></li>
</ul>
</section>
<section id="setting-up" class="level2">
<h2 class="anchored" data-anchor-id="setting-up">Setting up</h2>
<section id="install-and-load-required-packages-for-first-sections" class="level3">
<h3 class="anchored" data-anchor-id="install-and-load-required-packages-for-first-sections">Install and load required packages for first sections</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("readr")</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)        <span class="co"># data import</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("dplyr")</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)        <span class="co"># data manipulation</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("ggplot2")</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)      <span class="co"># data visualisation</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("car")</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)          <span class="co"># Companion to the book "An R Companion to Applied Regression"</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("performance")</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)  <span class="co"># Assessment of regression models performance</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<blockquote class="blockquote">
<p>Remember to use <kbd>Ctrl</kbd>+<kbd>Enter</kbd> to execute a command from the script.</p>
</blockquote>
</section>
<section id="new-project" class="level3">
<h3 class="anchored" data-anchor-id="new-project">New project</h3>
<ul>
<li>Click the “File” menu button (top left corner), then “New Project”</li>
<li>Click “New Directory”</li>
<li>Click “New Project” (“Empty project” if you have an older version of RStudio)</li>
<li>In “Directory name”, type the name of your project, e.g.&nbsp;“r_statistics”</li>
<li>Select the folder where to locate your project: for example, a <code>Documents/RProjects</code> folder, which you can create if it doesn’t exist yet.</li>
<li>Click the “Create Project” button</li>
</ul>
</section>
<section id="create-a-script" class="level3">
<h3 class="anchored" data-anchor-id="create-a-script">Create a script</h3>
<p>We will use a script to write code more comfortably.</p>
<ul>
<li>Menu: Top left corner, click the green “plus” symbol, or press the shortcut (for Windows/Linux) <kbd>Ctrl</kbd>+Shift+N or (for Mac) <kbd>Cmd</kbd>+<kbd>Shift</kbd>+<kbd>N</kbd>. This will open an “Untitled1” file.</li>
<li>Go to “File &gt; Save” or press (for Windows/Linux) <kbd>Ctrl</kbd>+<kbd>S</kbd> or (for Mac) <kbd>Cmd</kbd>+<kbd>S</kbd>. This will ask where you want to save your file and the name of the new file.</li>
<li>Call your file “process.R”</li>
</ul>
</section>
<section id="introducing-our-data" class="level3">
<h3 class="anchored" data-anchor-id="introducing-our-data">Introducing our data</h3>
<p>The following section will be using data from <a href="https://link.springer.com/article/10.1007/BF00349318">Constable (1993)</a> to explore how three different feeding regimes affect the size of sea urchins over time.</p>
<p>Sea urchins reportedly regulate their size according to the level of food available to regulate maintenance requirements. The paper examines whether a reduction in suture width (i.e., connection points between plates; see Fig. 1 from constable 1993) is the basis for shrinking due to low food conditions.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Constable-1993-fig1.PNG" class="img-fluid figure-img"></p>
<figcaption>Figure 1 from Constable 1993 paper showing sea urchin plates and suture width</figcaption>
</figure>
</div>
<p>The <a href="https://tidymodels.org/start/models/urchins.csv">data in csv format</a> is available from the tidymodels website.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>urchins <span class="ot">&lt;-</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>   <span class="co"># read in the data</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">read_csv</span>(<span class="st">"https://tidymodels.org/start/models/urchins.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>   <span class="co"># change the names to be more descriptive</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">"food_regime"</span>, <span class="st">"initial_volume"</span>, <span class="st">"width"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>   <span class="co"># convert food_regime from character to factor, helpful for modeling</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">food_regime =</span> <span class="fu">factor</span>(food_regime, </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Initial"</span>, <span class="st">"Low"</span>, <span class="st">"High"</span>)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>urchins <span class="co"># see the data as a tibble</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["food_regime"],"name":[1],"type":["fct"],"align":["left"]},{"label":["initial_volume"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["width"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"Initial","2":"3.5","3":"0.010"},{"1":"Initial","2":"5.0","3":"0.020"},{"1":"Initial","2":"8.0","3":"0.061"},{"1":"Initial","2":"10.0","3":"0.051"},{"1":"Initial","2":"13.0","3":"0.041"},{"1":"Initial","2":"13.0","3":"0.061"},{"1":"Initial","2":"15.0","3":"0.041"},{"1":"Initial","2":"15.0","3":"0.071"},{"1":"Initial","2":"16.0","3":"0.092"},{"1":"Initial","2":"17.0","3":"0.051"},{"1":"Initial","2":"19.0","3":"0.051"},{"1":"Initial","2":"20.0","3":"0.082"},{"1":"Initial","2":"21.0","3":"0.102"},{"1":"Initial","2":"21.0","3":"0.092"},{"1":"Initial","2":"24.0","3":"0.051"},{"1":"Initial","2":"24.0","3":"0.061"},{"1":"Initial","2":"24.0","3":"0.082"},{"1":"Initial","2":"28.0","3":"0.071"},{"1":"Initial","2":"29.0","3":"0.071"},{"1":"Initial","2":"35.0","3":"0.082"},{"1":"Initial","2":"36.0","3":"0.061"},{"1":"Initial","2":"39.0","3":"0.082"},{"1":"Initial","2":"39.0","3":"0.112"},{"1":"Initial","2":"44.0","3":"0.102"},{"1":"Low","2":"5.0","3":"0.041"},{"1":"Low","2":"8.0","3":"0.031"},{"1":"Low","2":"8.5","3":"0.041"},{"1":"Low","2":"11.5","3":"0.082"},{"1":"Low","2":"10.0","3":"0.071"},{"1":"Low","2":"14.0","3":"0.051"},{"1":"Low","2":"15.0","3":"0.061"},{"1":"Low","2":"15.5","3":"0.082"},{"1":"Low","2":"18.0","3":"0.061"},{"1":"Low","2":"18.0","3":"0.061"},{"1":"Low","2":"18.0","3":"0.071"},{"1":"Low","2":"22.0","3":"0.041"},{"1":"Low","2":"21.5","3":"0.061"},{"1":"Low","2":"20.5","3":"0.061"},{"1":"Low","2":"25.0","3":"0.082"},{"1":"Low","2":"26.0","3":"0.061"},{"1":"Low","2":"38.0","3":"0.071"},{"1":"Low","2":"41.0","3":"0.082"},{"1":"Low","2":"41.0","3":"0.061"},{"1":"Low","2":"43.0","3":"0.061"},{"1":"Low","2":"45.0","3":"0.071"},{"1":"High","2":"7.5","3":"0.051"},{"1":"High","2":"9.5","3":"0.051"},{"1":"High","2":"9.0","3":"0.082"},{"1":"High","2":"9.0","3":"0.092"},{"1":"High","2":"12.0","3":"0.092"},{"1":"High","2":"13.0","3":"0.061"},{"1":"High","2":"14.5","3":"0.051"},{"1":"High","2":"15.0","3":"0.102"},{"1":"High","2":"13.0","3":"0.112"},{"1":"High","2":"11.5","3":"0.071"},{"1":"High","2":"14.0","3":"0.071"},{"1":"High","2":"14.0","3":"0.051"},{"1":"High","2":"15.5","3":"0.082"},{"1":"High","2":"15.0","3":"0.092"},{"1":"High","2":"17.5","3":"0.102"},{"1":"High","2":"19.0","3":"0.122"},{"1":"High","2":"19.0","3":"0.102"},{"1":"High","2":"19.5","3":"0.163"},{"1":"High","2":"20.0","3":"0.051"},{"1":"High","2":"23.5","3":"0.112"},{"1":"High","2":"30.0","3":"0.153"},{"1":"High","2":"26.0","3":"0.082"},{"1":"High","2":"29.0","3":"0.122"},{"1":"High","2":"39.0","3":"0.102"},{"1":"Low","2":"47.5","3":"0.041"},{"1":"Low","2":"46.5","3":"0.061"},{"1":"Low","2":"11.5","3":"0.031"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>We have 72 urchins with data on:</p>
<ul>
<li>experimental feeding regime group with 3 levels (Initial, Low, or High)</li>
<li>size in milliliters at the start of the experiment (initial_volume)</li>
<li>suture width in millimeters at the end of the experiment (width, see Fig. 1)</li>
</ul>
</section>
</section>
<section id="statistics-in-r-using-base-and-stats" class="level2">
<h2 class="anchored" data-anchor-id="statistics-in-r-using-base-and-stats">Statistics in R using base and stats</h2>
<section id="visualise-the-data" class="level3">
<h3 class="anchored" data-anchor-id="visualise-the-data">Visualise the data</h3>
<p>Use a boxplot to visualize width versus <code>food_regime</code> as a factor and a scatterplot for width versus <code>initial_volume</code> as a continuous variable.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(width <span class="sc">~</span> food_regime, <span class="at">data =</span> urchins)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="anova-lm_files/figure-html/initial-plots-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(width <span class="sc">~</span> initial_volume, <span class="at">data =</span> urchins)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="anova-lm_files/figure-html/initial-plots-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can see that there are some relationships between the response variable (width) and our two covariates (food_regime and initial volume). But what about the interaction between the two covariates?</p>
<p><strong>Challenge 1 - Use ggplot2 to make a plot visualising the interaction between our two variables. Add a trendline to the data.</strong></p>
<blockquote class="blockquote">
<p>Hint: think about grouping and coloring.</p>
</blockquote>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(urchins,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> initial_volume,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> width,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> food_regime)) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="co"># add a linear trend line without a confidence interval</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="anova-lm_files/figure-html/ggplot2-scatter-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Urchins that were larger in volume at the start of the experiment tended to have wider sutures at the end. Slopes of the lines look different so this effect may depend on the feeding regime indicating we should include an interaction term.</p>
</section>
<section id="analysis-of-variance-anova" class="level3">
<h3 class="anchored" data-anchor-id="analysis-of-variance-anova">Analysis of Variance (ANOVA)</h3>
<p>Information in this section was taken from <a href="https://rpubs.com/tmcurley/twowayanova">rpubs.com</a> and <a href="https://bookdown.org/steve_midway/DAR/understanding-anova-in-r.html#multiple-comparisons">Data Analysis in R Ch 7</a>.</p>
<p>We can do an ANOVA with the <code>aov()</code> function to test for differences in sea urchin suture width between our groups. We are technically running and <strong>analysis of covariance (ANCOVA)</strong> as we have both a continuous and a categorical variable. ANOVAs are for categorical variables and we will see that some of the <em>post-hoc</em> tests are not amenable to continuous variables.</p>
<blockquote class="blockquote">
<p><code>aov()</code> uses the model formula <code>response variable ~ covariate1 + covariate2</code>. The * denotes the inclusion of both main effects and interactions which we have done below. The formula below is equivalent to <code>reponse ~ covar1 + covar2 + covar1:covar2</code> i.e., the main effect of covar1 and covar2, and the interaction between the two.</p>
</blockquote>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>aov_urch <span class="ot">&lt;-</span> <span class="fu">aov</span>(width <span class="sc">~</span> food_regime <span class="sc">*</span> initial_volume, </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> urchins)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov_urch)  <span class="co"># print the summary statistics</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           Df   Sum Sq  Mean Sq F value   Pr(&gt;F)    
food_regime                 2 0.012380 0.006190  13.832 9.62e-06 ***
initial_volume              1 0.008396 0.008396  18.762 5.15e-05 ***
food_regime:initial_volume  2 0.004609 0.002304   5.149  0.00835 ** 
Residuals                  66 0.029536 0.000448                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Both the main effects and interaction are significant (p &lt; 0.05) indicating a significant interactive effect between food regime and initial volume on urchin suture width. We need to do a pairwise-comparison to find out which factor levels and combination of the two covariates have the largest effect on width.</p>
<section id="pair-wise-comparison" class="level4">
<h4 class="anchored" data-anchor-id="pair-wise-comparison">Pair-wise comparison</h4>
<p>Run a <strong>Tukey’s Honestly Significant Difference (HSD)</strong> test - note it does not work for non-factors as per the warning message.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(aov_urch)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in replications(paste("~", xx), data = mf): non-factors ignored:
initial_volume</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in replications(paste("~", xx), data = mf): non-factors ignored:
food_regime, initial_volume</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in TukeyHSD.aov(aov_urch): 'which' specified some non-factors which
will be dropped</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = width ~ food_regime * initial_volume, data = urchins)

$food_regime
                     diff          lwr         upr     p adj
Low-Initial  -0.006791667 -0.021433881 0.007850548 0.5100502
High-Initial  0.023791667  0.009149452 0.038433881 0.0006687
High-Low      0.030583333  0.015941119 0.045225548 0.0000129</code></pre>
</div>
</div>
<p>The comparison between High-Initial and High-Low food regimes are significant (p &lt; 0.05).</p>
</section>
<section id="checking-the-model" class="level4">
<h4 class="anchored" data-anchor-id="checking-the-model">Checking the model</h4>
<p>We also want to check that our model is a good fit and does not violate any ANOVA <strong>assumptions</strong>:</p>
<ol type="1">
<li>Data are independent and normally distributed.</li>
<li>The residuals from the data are normally distributed (homogeneity of variance).</li>
<li>The variances of the sampled populations are equal.</li>
</ol>
<section id="normal-distribution" class="level5">
<h5 class="anchored" data-anchor-id="normal-distribution">Normal distribution</h5>
<p><strong>Challenge 2 - Use a histogram and quantile-quantile (QQ) plots to visually check data are normally distributed</strong>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(urchins<span class="sc">$</span>width)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="anova-lm_files/figure-html/normality-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run the two together to combine them</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(urchins<span class="sc">$</span>width)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(urchins<span class="sc">$</span>width)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="anova-lm_files/figure-html/normality-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>QQ plots show the actual data vs their theoretical quantiles (i.e.&nbsp;the quantiles if the data was normally distributed). If the data was normally distributed, the points would follow closely the diagonal.</p>
<p>You could also run a Shapiro-Wilk test on the data:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(urchins<span class="sc">$</span>width)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  urchins$width
W = 0.95726, p-value = 0.01552</code></pre>
</div>
</div>
<p>The p-value is less than 0.05 so the data are significantly different from a normal distribution.</p>
</section>
<section id="homogeneity-of-variance" class="level5">
<h5 class="anchored" data-anchor-id="homogeneity-of-variance">Homogeneity of variance</h5>
<p>We plot the model’s residuals (difference between observed and predicted values) versus the fitted values to check for homogeneity of variance - we do not want too much deviation from 0. (The red line is the average of the values.)</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(aov_urch, <span class="dv">1</span>) <span class="co"># only plot first of 4 plots</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="anova-lm_files/figure-html/residuals-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can also plot the predicted values from the model with the actual values:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predict</span>(aov_urch) <span class="sc">~</span> urchins<span class="sc">$</span>width)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="co"># plot a red line with intercept of 0 and slope of 1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="anova-lm_files/figure-html/predicted-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This QQ plot show the residuals vs their theoretical quantiles (i.e.&nbsp;the quantiles if the data was normally distributed). If the residuals were normally distributed, they would follow closely the diagonal.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(aov_urch, <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="anova-lm_files/figure-html/qqplot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>To check the normality of residuals, we can also run a Shapiro-Wilk test on residuals:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">resid</span>(aov_urch))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  resid(aov_urch)
W = 0.98456, p-value = 0.5244</code></pre>
</div>
</div>
<p>The residuals fall on the Normal Q-Q plot diagonal and the Shapiro-Wilk result is non-significant (p &gt; 0.05), which means we can’t reject the hypothesis that the data comes from a population with a normal distribution.</p>
<p>Another way to check for homogeneity of variance is by using Levene’s test.</p>
<p><strong>Challenge 3 - use the help documentation for <code>leveneTest()</code> from the <code>car</code> package to check homogeneity of variance on <code>food_regime</code>.</strong></p>
<blockquote class="blockquote">
<p>Again, only works for factor groups.</p>
</blockquote>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(width <span class="sc">~</span> food_regime, <span class="at">data =</span> urchins)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["F value"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"2","2":"4.422386","3":"0.01559113","_rn_":"group"},{"1":"69","2":"NA","3":"NA","_rn_":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The Levene’s Test is significant for <code>food_regime</code>, which is not what we were hoping for: it means the assumption of homogeneity of variance is not met. There are a few options to deal with this. You can ignore this violation based on your own <em>a priori</em> knowledge of the distribution of the population being samples, drop the p-value significance, or use a different test.</p>
</section>
</section>
</section>
<section id="linear-model" class="level3">
<h3 class="anchored" data-anchor-id="linear-model">Linear Model</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>lm_urch <span class="ot">&lt;-</span> <span class="fu">lm</span>(width <span class="sc">~</span> food_regime <span class="sc">*</span> initial_volume, </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> urchins)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_urch)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = width ~ food_regime * initial_volume, data = urchins)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.045133 -0.013639  0.001111  0.013226  0.067907 

Coefficients:
                                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                     0.0331216  0.0096186   3.443 0.001002 ** 
food_regimeLow                  0.0197824  0.0129883   1.523 0.132514    
food_regimeHigh                 0.0214111  0.0145318   1.473 0.145397    
initial_volume                  0.0015546  0.0003978   3.908 0.000222 ***
food_regimeLow:initial_volume  -0.0012594  0.0005102  -2.469 0.016164 *  
food_regimeHigh:initial_volume  0.0005254  0.0007020   0.748 0.456836    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.02115 on 66 degrees of freedom
Multiple R-squared:  0.4622,    Adjusted R-squared:  0.4215 
F-statistic: 11.35 on 5 and 66 DF,  p-value: 6.424e-08</code></pre>
</div>
</div>
<p>In the output, we have the model call, residuals, and the coefficients. The first coefficient is the <code>(Intercept)</code> and you might notice the <code>food_regimeInitial</code> is missing. The function defaults to an effects parameterisation where the intercept is the reference or baseline of the categorical group - Initial in this case.</p>
<blockquote class="blockquote">
<p>You can change the reference level of a factor using the <code>relevel()</code> function.</p>
</blockquote>
<p>The estimates of the remaining group levels of <code>food_regime</code> represents the effect of being in that group. To calculate the group coefficients for all group levels you <em>add</em> the estimates for the level to the intercept (first group level) estimate. For example, the estimate for the ‘Initial’ feeding regime is 0.0331 and we add the estimate of ‘Low’ (0.0331 + 0.0197) to get the mean maximum size of 0.0528 mm for width.</p>
<p>For the continuous covariate, the estimate represents the change in the response variable for a unit increase in the covariate. For example, <code>initial_volume</code>’s estimate of 0.0015 represents a 0.0015 mm increase (the estimate is positive) in width per ml increase in urchin initial volume.</p>
<p>We can get ANOVA test statistics on our linear model using <code>anova()</code> in base or <code>Anova()</code> from the <code>car</code> package.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm_urch)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["Sum Sq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Mean Sq"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"2","2":"0.012380083","3":"0.0061900417","4":"13.832142","5":"9.616282e-06","_rn_":"food_regime"},{"1":"1","2":"0.008396235","3":"0.0083962349","4":"18.762057","5":"5.153633e-05","_rn_":"initial_volume"},{"1":"2","2":"0.004608803","3":"0.0023044014","4":"5.149369","5":"8.353667e-03","_rn_":"food_regime:initial_volume"},{"1":"66","2":"0.029535754","3":"0.0004475114","4":"NA","5":"NA","_rn_":"Residuals"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(lm_urch)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Sum Sq"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.016865255","2":"2","3":"18.843380","4":"3.358002e-07","_rn_":"food_regime"},{"1":"0.008396235","2":"1","3":"18.762057","4":"5.153633e-05","_rn_":"initial_volume"},{"1":"0.004608803","2":"2","3":"5.149369","4":"8.353667e-03","_rn_":"food_regime:initial_volume"},{"1":"0.029535754","2":"66","3":"NA","4":"NA","_rn_":"Residuals"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>These are effectively the same as the <code>aov()</code> model we ran before.</p>
<blockquote class="blockquote">
<p><strong>Note</strong>: The statistics outputs are the same comparing the <code>aov()</code> and <code>anova()</code> models while the <code>Anova()</code> model is <strong>not</strong> exactly the same. The <code>Anova()</code> output tells us it was a Type II test and the <code>aov()</code> documentation says it is only for <em>balanced</em> designs which means the Type 1 test is applied (see <a href="https://bookdown.org/ndphillips/YaRrr/type-i-type-ii-and-type-iii-anovas.html">here</a>). The type of test can be set for <code>Anova()</code> but not the others. Here, the overall take-away from the different ANOVA functions are comparable.</p>
</blockquote>
<p><strong>Challenge 4 - use the check_model() documentation to apply the function to our <code>lm_urch</code> model.</strong></p>
<p>The performance package has a handy function <code>check_model()</code> that will check several aspects of your model in one go:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(lm_urch)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="anova-lm_files/figure-html/check-model-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>Challenge 5 - conduct your own ANOVA or linear regression using the mgp dataset from {ggplot2}.</strong></p>
<ol type="1">
<li>Test whether # of cylinders and/or engine displacement affect fuel efficiency.</li>
<li>Make a plot to visualize the relationship.</li>
</ol>
<blockquote class="blockquote">
<p><strong>Hint</strong>: Check out the documentation for the dataset <code>?mpg</code> to see the variables in the dataset. Are the variables the right data type? Suggest saving the dataset locally in your environment i.e., <code>mpg2 &lt;- mpg</code> so you can change data types if necessary.</p>
</blockquote>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>mpg2 <span class="ot">&lt;-</span>  mpg</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>mpg2<span class="sc">$</span>cyl <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(mpg<span class="sc">$</span>cyl) <span class="co"># convert cyl from numeric to factor</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># base R ANOVA</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>aov_cars <span class="ot">&lt;-</span> <span class="fu">aov</span>(hwy <span class="sc">~</span> cyl <span class="sc">*</span> displ, <span class="at">data =</span> mpg2)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov_cars)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
cyl           3   4836  1612.1  142.69  &lt; 2e-16 ***
displ         1    219   218.8   19.37 1.66e-05 ***
cyl:displ     2    642   321.1   28.42 9.65e-12 ***
Residuals   227   2565    11.3                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(aov_cars, <span class="st">"cyl"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in replications(paste("~", xx), data = mf): non-factors ignored: displ</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in replications(paste("~", xx), data = mf): non-factors ignored: cyl,
displ</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = hwy ~ cyl * displ, data = mpg2)

$cyl
            diff        lwr       upr     p adj
5-4  -0.05246914  -4.508182  4.403244 0.9999898
6-4  -5.97968433  -7.355259 -4.604110 0.0000000
8-4 -11.17389771 -12.593534 -9.754261 0.0000000
6-5  -5.92721519 -10.385582 -1.468848 0.0038274
8-5 -11.12142857 -15.593586 -6.649271 0.0000000
8-6  -5.19421338  -6.622156 -3.766270 0.0000000</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># linear model</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>lm_cars <span class="ot">&lt;-</span> <span class="fu">lm</span>(hwy <span class="sc">~</span> cyl <span class="sc">*</span> displ, <span class="at">data =</span> mpg2)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_cars)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = hwy ~ cyl * displ, data = mpg2)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.6698 -2.0533 -0.4563  1.6948 13.1597 

Coefficients: (1 not defined because of singularities)
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   46.601      2.586  18.018  &lt; 2e-16 ***
cyl5           2.887      1.773   1.628  0.10484    
cyl6         -10.221      3.795  -2.693  0.00760 ** 
cyl8         -35.626      4.390  -8.114 3.07e-14 ***
displ         -8.295      1.193  -6.954 3.74e-11 ***
cyl5:displ        NA         NA      NA       NA    
cyl6:displ     4.318      1.440   2.998  0.00302 ** 
cyl8:displ     9.591      1.376   6.969 3.43e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.361 on 227 degrees of freedom
Multiple R-squared:  0.6896,    Adjusted R-squared:  0.6814 
F-statistic: 84.05 on 6 and 227 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(lm_cars) <span class="co"># from the car package</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Note: model has aliased coefficients
      sums of squares computed by model comparison</code></pre>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Sum Sq"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"207.1571","2":"3","3":"6.112251","4":"5.138833e-04","_rn_":"cyl"},{"1":"218.7795","2":"1","3":"19.365519","4":"1.661112e-05","_rn_":"displ"},{"1":"642.1682","2":"2","3":"28.421131","4":"9.653581e-12","_rn_":"cyl:displ"},{"1":"2564.5036","2":"227","3":"NA","4":"NA","_rn_":"Residuals"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg2,</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> displ,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> hwy,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> cyl)) <span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="anova-lm_files/figure-html/plot-mpg-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="the-inbetween" class="level2">
<h2 class="anchored" data-anchor-id="the-inbetween">The inbetween…</h2>
<p>Before going into Tidymodels, it should be mentioned there are <em>many</em> excellent linear regression packages. To name a few:</p>
<ul>
<li>nlme</li>
<li>lmer</li>
<li>lmerTest</li>
<li>glmmTMB</li>
<li>and more…</li>
</ul>
<p>The packages vary in the methods, how to specify random factors, etc. The model outputs also tend to be not so friendly to export into a table and document.</p>
</section>
<section id="introducing-tidymodels" class="level2">
<h2 class="anchored" data-anchor-id="introducing-tidymodels">Introducing Tidymodels</h2>
<p>Like the tidyverse package, the Tidymodels framework is a collection of packages for modeling and machine learning following the tidyverse principles.</p>
<section id="load-more-packages" class="level3">
<h3 class="anchored" data-anchor-id="load-more-packages">Load more packages</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("tidymodels")</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels) <span class="co"># for parsnip package and rest of tidymodels</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("dotwhisker")</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dotwhisker)<span class="co"># for visualizing regression results</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="build-and-fit-a-model" class="level3">
<h3 class="anchored" data-anchor-id="build-and-fit-a-model">Build and fit a model</h3>
<p>Let’s apply a standard two-way analysis of variance (ANOVA) model to the dataset as we did before. For this kind of model, ordinary least squares is a good initial approach.</p>
<p>For Tidymodels, we need to specify the following:</p>
<ol type="1">
<li>The <em>functional form</em> using the <a href="https://parsnip.tidymodels.org/">parsnip package</a>.</li>
<li>The <em>method for fitting</em> the model by setting the <strong>engine</strong>.</li>
</ol>
<p>We will specify the <em>functional form</em> or model type as <a href="https://parsnip.tidymodels.org/reference/linear_reg.html">“linear regression”</a> as there is a numeric outcome with a linear slope and intercept. We can do this with:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">linear_reg</span>()  </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear Regression Model Specification (regression)

Computational engine: lm </code></pre>
</div>
</div>
<p>On its own, not that interesting. Next, we specify the method for <em>fitting</em> or training the model using the <code>set_engine()</code> function. The engine value is often a mash-up of the software that can be used to fit or train the model as well as the estimation method. For example, to use ordinary least squares, we can set the engine to be <code>lm</code>.</p>
<p>The <a href="https://parsnip.tidymodels.org/reference/linear_reg.html">documentation page</a> for linear_reg() lists the possible engines. We’ll save this model object as lm_mod.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>lm_mod <span class="ot">&lt;-</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">set_engine</span>(<span class="st">"lm"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Next, the model can be estimated or trained using the <code>fit()</code> function and the model formula we used for the ANOVA:</p>
<p><code>width ~ initial_volume * food_regime</code></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>lm_fit <span class="ot">&lt;-</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>   lm_mod <span class="sc">%&gt;%</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">fit</span>(width <span class="sc">~</span> initial_volume <span class="sc">*</span> food_regime, <span class="at">data =</span> urchins)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>lm_fit</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>parsnip model object


Call:
stats::lm(formula = width ~ initial_volume * food_regime, data = data)

Coefficients:
                   (Intercept)                  initial_volume  
                     0.0331216                       0.0015546  
                food_regimeLow                 food_regimeHigh  
                     0.0197824                       0.0214111  
 initial_volume:food_regimeLow  initial_volume:food_regimeHigh  
                    -0.0012594                       0.0005254  </code></pre>
</div>
</div>
<p>We can use the <code>tidy()</code> function for our <code>lm</code> object to output model parameter estimates and their statistical properties. Similar to <code>summary()</code> but the results are more predictable and in a useful format.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"0.0331216259","3":"0.0096186287","4":"3.4434873","5":"0.0010020308"},{"1":"initial_volume","2":"0.0015546403","3":"0.0003978337","4":"3.9077643","5":"0.0002220426"},{"1":"food_regimeLow","2":"0.0197823628","3":"0.0129883393","4":"1.5230864","5":"0.1325144691"},{"1":"food_regimeHigh","2":"0.0214111044","3":"0.0145317736","4":"1.4733993","5":"0.1453969848"},{"1":"initial_volume:food_regimeLow","2":"-0.0012593696","3":"0.0005101652","4":"-2.4685525","5":"0.0161637663"},{"1":"initial_volume:food_regimeHigh","2":"0.0005253946","3":"0.0007019580","4":"0.7484702","5":"0.4568356317"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>This output can be used to generate a dot-and-whisker plot of our regression results using the <code>dotwhisker</code> package:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm_fit) <span class="sc">%&gt;%</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">dwplot</span>(<span class="at">dot_args =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">whisker_args =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">vline =</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">color =</span> <span class="st">"grey50"</span>,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">linetype =</span> <span class="dv">2</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using the `size` aesthetic with geom_segment was deprecated in ggplot2 3.4.0.
ℹ Please use the `linewidth` aesthetic instead.
ℹ The deprecated feature was likely used in the dotwhisker package.
  Please report the issue at &lt;https://github.com/fsolt/dotwhisker/issues&gt;.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="anova-lm_files/figure-html/dotwhisker-plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="use-a-model-to-predict" class="level2">
<h2 class="anchored" data-anchor-id="use-a-model-to-predict">Use a model to predict</h2>
<p>Say that it would be interesting to make a plot of the mean body size for urchins that started the experiment with an initial volume of 20 ml.</p>
<p>First, lets make some new example data to predict for our graph:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>new_points <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">initial_volume =</span> <span class="dv">20</span>,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">food_regime =</span> <span class="fu">c</span>(<span class="st">"Initial"</span>, <span class="st">"Low"</span>, <span class="st">"High"</span>))</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>new_points</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["initial_volume"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["food_regime"],"name":[2],"type":["fct"],"align":["left"]}],"data":[{"1":"20","2":"Initial"},{"1":"20","2":"Low"},{"1":"20","2":"High"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>We can then use the <code>predict()</code> function to find the mean values at 20 ml initial volume.</p>
<p>With tidymodels, the types of predicted values are standardized so that we can use the same syntax to get these values.</p>
<p>Let’s generate the mean suture width values:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>mean_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_fit, <span class="at">new_data =</span> new_points)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>mean_pred</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".pred"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.06421443"},{"1":"0.05880940"},{"1":"0.09613343"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>When making predictions, the tidymodels convention is to always produce a tibble of results with standardized column names. This makes it easy to combine the original data and the predictions in a usable format:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>conf_int_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_fit, </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">new_data =</span> new_points,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">"conf_int"</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>conf_int_pred</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".pred_lower"],"name":[1],"type":["dbl"],"align":["right"]},{"label":[".pred_upper"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.05549934","2":"0.07292952"},{"1":"0.04986251","2":"0.06775629"},{"1":"0.08696233","2":"0.10530453"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># now combine:</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>   new_points <span class="sc">%&gt;%</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">bind_cols</span>(mean_pred, conf_int_pred)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>plot_data</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["initial_volume"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["food_regime"],"name":[2],"type":["fct"],"align":["left"]},{"label":[".pred"],"name":[3],"type":["dbl"],"align":["right"]},{"label":[".pred_lower"],"name":[4],"type":["dbl"],"align":["right"]},{"label":[".pred_upper"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"20","2":"Initial","3":"0.06421443","4":"0.05549934","5":"0.07292952"},{"1":"20","2":"Low","3":"0.05880940","4":"0.04986251","5":"0.06775629"},{"1":"20","2":"High","3":"0.09613343","4":"0.08696233","5":"0.10530453"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># and plot:</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_data, </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> food_regime)) <span class="sc">+</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> .pred)) <span class="sc">+</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> .pred_lower,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ymax =</span> .pred_upper),</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">width =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"urchin size"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="anova-lm_files/figure-html/combine-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There is also an example of a <em>Bayesian</em> model in the tidymodels article I have not included here.</p>
</section>
<section id="close-project" class="level2">
<h2 class="anchored" data-anchor-id="close-project">Close project</h2>
<p>Closing RStudio will ask you if you want to save your workspace and scripts. Saving your workspace is usually not recommended if you have all the necessary commands in your script.</p>
</section>
<section id="useful-links" class="level2">
<h2 class="anchored" data-anchor-id="useful-links">Useful links</h2>
<ul>
<li>For statistical analysis in R:
<ul>
<li>Steve Midway’s <a href="https://bookdown.org/steve_midway/DAR/part-ii-analysis.html">Data Analysis in R Part II Analysis</a></li>
<li>Jeffrey A. Walker’s <a href="https://middleprofessor.github.io/benchbiostats/">Applied Statistics for Experiemental Biology</a></li>
<li>Chester Ismay and Albert Y. Kim’s <a href="https://moderndive.com/">ModernDive Statistical Inference via Data Science</a></li>
</ul></li>
<li>For tidymodels:
<ul>
<li><a href="https://www.tidymodels.org/">tidymodels website</a></li>
</ul></li>
<li>Our compilation of <a href="../../R/usefullinks.html">general R resources</a></li>
</ul>
</section>
<section id="licence" class="level2">
<h2 class="anchored" data-anchor-id="licence">Licence</h2>
<p>Because it draws heavily from the <a href="https://github.com/tidymodels/tidymodels.org?tab=readme-ov-file#tidymodelsorg">CC BY-SA-licensed</a> <a href="https://www.tidymodels.org/start/models/">Tidymodels article titled “Build a model”</a>, this material is also released under a <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0 licence</a>.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/uqlibrary\.github\.io\/technology-training\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>